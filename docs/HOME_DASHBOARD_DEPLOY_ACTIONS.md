name: Обновление главной страницы и действий деплоя
description: Новый UI быстрых ссылок и действий на главной странице, drag-and-drop задач, API для запуска скриптов деплоя и вспомогательные shell-скрипты.

# Главная страница: навигация, задачи и деплой

## Обзор
- Навигационный пункт «Нейросервисы» переименован в «AI и ML», карточки быстрых ссылок получили описания и бейджи.
- Виджет задач обновлён: drag-and-drop с подсветкой, drop-зонами и переносом в корень.
- Блок «Быстрые действия» запускает подготовленные скрипты (git pull, backend, frontend, deploy.sh).
- На бэкенде появился REST-роут `/api/actions/:action/run`, который стартует shell-скрипты от имени администратора.
- В каталоге `scripts/` лежат отдельные сценарии для обновления репозитория и сервисов.

## Изменения во фронтенде
- `src/components/Sidebar.jsx`: переименование пункта меню на «AI и ML».
- `src/pages/Home.jsx`:
  - Обновлён массив `quickLinks`: описания, бейджи и визуальные эффекты карточек.
  - `quickDeployActions` + состояние `runningAction/actionResult` управляют запуском скриптов.
  - Drag-and-drop дерева задач: линии before/after, подсветка карточки при наведении, drop-зона корня.
  - Кнопки быстрого деплоя переведены в сетку, отображают спиннер во время выполнения.
  - Кнопки действий по задаче заменены на иконки (добавить / редактировать / удалить).

## API и безопасность
- Новый роут `backend/routes/actions.js` (подключён в `backend/index.js`):
  - Требует `authRequired` и `requirePermission(['admin_access'])`.
  - Использует карту путей до скриптов (можно переопределять переменными окружения `PORTAL_SCRIPT_*`).
  - Запускает `bash`, пишет запись в `admin_logs`, задаёт таймауты и размер буфера.

## Shell-скрипты
- `scripts/git_pull.sh` — вытягивание origin/<branch> и обновление сабмодулей.
- `scripts/update_backend.sh` — `npm ci` в backend и `systemctl restart` сервиса.
- `scripts/update_frontend.sh` — `npm ci`, `vite build` и, при наличии, проверка/перезагрузка Nginx.
- Локальные переменные (`PROJECT_DIR`, `BRANCH`, `SERVICE_NAME`) переопределяются при запуске; логика повторяет `deploy.sh`.

## UX и статус
- Drop-зоны: отдельные области для «до/после» и вставки в подзадачи, подсказки при наведении.
- Пустое состояние задач — крупный drop-блок, перетаскивание в корень доступно сразу.
- Блок быстрых действий адаптивен: 2×2 на узких экранах, 1×4 на широких, показывает только иконку и название.
- Кнопки действий по задаче стали компактными, добавлены подсказки (`title`) и `sr-only` подписи.

## Развёртывание и проверка
1. На сервере выдать права: `chmod +x scripts/*.sh deploy.sh`.
2. При необходимости обновить переменные окружения (например, `PORTAL_SCRIPT_BACKEND`).
3. Перезапустить backend, чтобы `actions`-роут стал доступен.
4. В интерфейсе администратора убедиться, что:
   - сдаётся drag-and-drop между уровнями и в корень;
   - каждый скрипт из блока «Быстрые действия» отрабатывает и пишет лог в `admin_logs`;
   - карточки быстрых ссылок и обновлённый текст отображаются корректно в светлой/тёмной теме.
